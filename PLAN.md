# PodCheck — Progress Tracker

Track your progress here. Check off tasks as you complete them.
Reference this file at the start of each Cursor session to know where you are.

## Current Status
- **Phase**: 5 — Results UI
- **Current Task**: TASK 17
- **Last Completed**: TASK 16

---

## Phase 1: Project Setup
- [x] TASK 1 — Create Laravel 12 project + push to GitHub
- [x] TASK 2 — Tailwind CSS + base layout
- [x] TASK 3 — Landing page with URL input form
- [x] TASK 4 — FeedReport model + migration

## Phase 2: Feed Fetching & Parsing
- [x] TASK 5 — FeedFetcher service
- [x] TASK 6 — FeedFetcher tests
- [x] TASK 7 — FeedCheckController basic flow

## Phase 3: Validation Engine
- [x] TASK 8 — CheckInterface + FeedValidator orchestrator
- [x] TASK 9 — ArtworkCheck
- [x] TASK 10 — CategoryCheck
- [x] TASK 11 — Remaining channel checks (batch)
- [x] TASK 12 — Episode-level checks
- [x] TASK 13 — Wire validator into controller

## Phase 4: Scoring
- [x] TASK 14 — HealthScorer
- [x] TASK 15 — SeoScorer
- [x] TASK 16 — Full pipeline integration test

## Phase 5: Results UI
- [ ] TASK 17 — Report page header + score badge
- [ ] TASK 18 — Check results list UI
- [ ] TASK 19 — Category score cards
- [ ] TASK 20 — Episode sampling summary
- [ ] TASK 21 — Polish landing page

## Phase 6: Polish & Ship
- [ ] TASK 22 — Loading state
- [ ] TASK 23 — Error handling UI
- [ ] TASK 24 — Caching
- [ ] TASK 25 — Meta tags + OG image
- [ ] TASK 26 — README
- [ ] TASK 27 — Deploy
- [ ] TASK 28 — Launch post

---

## Notes
- **TASK 1**: Restarted with clean Laravel 12 install (no starter kit). Added Tailwind CSS 4, Alpine.js, and Pest PHP. Previous Livewire starter kit had unnecessary auth/Flux/Fortify scaffolding.
- **TASK 4**: Created FeedReport model with ULID primary key, JSON casting for results, auto-generated slug on creation, and route-model binding via slug. Migration includes index on feed_url for lookup performance.
- **TASK 5**: Created FeedFetcher service with `fetch(string $url): SimpleXMLElement` method. Uses constructor-injected HTTP client (no facades), 10s timeout, 3 max redirects. Custom FeedFetchException with static factory methods for specific error scenarios (invalid URL, timeout, 404, SSL errors, non-XML response, not an RSS feed). Validates URL scheme, parses XML with libxml error handling, and verifies root element is `rss` or `feed`.
- **TASK 6**: Added 24 Pest unit tests for FeedFetcher covering: valid RSS/Atom feed parsing, channel data accessibility, invalid URL handling (empty, malformed, missing scheme, FTP scheme), HTTP-only URL acceptance, timeout handling (two variants), SSL/certificate errors, generic connection failures, HTTP error responses (404, 403, 500, 503), empty/whitespace-only responses, and non-XML response handling (HTML, JSON, plain text, malformed XML, valid XML that isn't RSS/Atom). Created test fixtures: `valid-rss-feed.xml` (3 episodes with full iTunes metadata) and `valid-atom-feed.xml`.
- **TASK 7**: Wired up FeedCheckController with constructor-injected FeedFetcher. `POST /check` validates URL, fetches feed, extracts title (RSS 2.0 and Atom), creates FeedReport with basic results JSON, and redirects to `/report/{slug}`. FeedFetchException errors redirect back with user-friendly messages. Added `GET /report/{slug}` route with `show()` method and `report.blade.php` view displaying feed title, URL, metadata, and raw JSON results. Enabled RefreshDatabase for feature tests. Wrote 12 Pest feature tests covering: successful flow (fetch → store → redirect), single report creation, validation errors (missing/invalid/too-long URL), fetch errors (404, non-XML) with redirect-back behavior, input preservation on error, report display, 404 for missing slugs, and graceful handling of null feed titles.
- **TASK 9**: Created `ArtworkCheck` in `app/Services/Checks/ChannelChecks/`. Extracts `<itunes:image>` href from RSS 2.0 and Atom feeds. Validates image via HEAD request for content type (JPEG/PNG required) and `getimagesize()` for dimensions (1400×1400 to 3000×3000, must be square). Returns fail for missing artwork or unsupported format, warn for unreachable images or out-of-range dimensions, pass for valid artwork. Uses constructor-injected `HttpFactory` (no facades). Wrote 11 Pest unit tests covering metadata, missing/empty artwork, invalid formats (GIF, WebP), content type parsing with charset, PNG support, dimension warnings, HEAD failure handling, and fixture extraction.
- **TASK 10**: Created `CategoryCheck` in `app/Services/Checks/ChannelChecks/`. Validates `<itunes:category>` against Apple's full podcast category taxonomy (19 primary categories with subcategories, hardcoded as const array). Extracts primary category and optional nested subcategory from feed XML. Returns fail for missing category or invalid primary category, warn for invalid subcategory or missing subcategory when one is available, pass for valid category/subcategory combinations. Categories with no subcategories (Technology, True Crime, Government, History) pass without requiring one. Handles XML entity encoding (`&amp;` in "Society & Culture", "Health & Fitness"). Wrote 16 Pest unit tests covering metadata, missing/empty categories, invalid categories, subcategory validation, all pass/warn/fail paths, and XML entity handling.
- **TASK 11**: Implemented all 6 remaining channel-level checks as a batch. **ExplicitTagCheck**: validates `<itunes:explicit>` presence and value; passes for "true"/"false", warns for legacy "yes"/"no" and non-standard values, fails when missing. **AuthorCheck**: validates `<itunes:author>` presence; warns when excessively long (>255 chars), fails when missing/empty. **OwnerEmailCheck**: validates `<itunes:owner>` with `<itunes:email>`; validates email format via `filter_var()`, fails when owner or email missing, warns on invalid email format. **LanguageCheck**: validates `<language>` tag against ISO 639-1 codes (full list of valid primary codes); accepts regional variants like "en-us", "pt-BR"; fails when missing, warns on invalid codes. **WebsiteLinkCheck**: validates `<link>` presence and URL format; requires http/https scheme via `filter_var()` + `parse_url()`; fails when missing, warns on invalid URLs. **DescriptionCheck**: checks `<description>` with fallback to `<itunes:summary>`; enforces 20-char minimum and 4000-char warning threshold; fails when missing, warns when too short or too long. All checks follow the established pattern: implement `CheckInterface`, use `getChannel()` helper for RSS 2.0/Atom support, return `CheckResult` value objects. Wrote 62 Pest unit tests across 6 test files (10-11 tests each) covering metadata, fail/warn/pass paths, edge cases (empty strings, whitespace, boundary lengths, case sensitivity). All 155 tests pass, Pint clean.
- **TASK 12**: Implemented all 6 episode-level checks. **EnclosureCheck**: validates `<enclosure>` presence, URL and type attributes; checks type against valid podcast media types (audio/mpeg, audio/x-m4a, audio/mp4, audio/ogg, etc.); verifies URL reachability via HEAD request; uses constructor-injected `HttpFactory`. **GuidCheck**: validates `<guid>` presence and uniqueness across episodes; uses stateful design (tracks seen GUIDs between runs) to detect duplicates; fails on missing, empty, or duplicate GUIDs. **PubDateCheck**: validates `<pubDate>` presence and RFC 2822 format; uses strict `DateTimeImmutable::RFC2822` parsing with loose `strtotime()` fallback for non-standard formats; warns on future dates. **DurationCheck**: validates `<itunes:duration>` presence and format; accepts HH:MM:SS, MM:SS, H:MM:SS, and total seconds formats. **TitleCheck**: validates episode title presence via `<itunes:title>` (preferred) or `<title>` fallback; detects generic non-descriptive titles matching "Episode N", "Ep. N", "Ep N", "#N" patterns via regex. **DescriptionCheck**: validates episode description presence via `<description>` with `<itunes:summary>` fallback; enforces 10-character minimum length. All checks run against individual `<item>` elements (FeedValidator caps at 10 episodes). Wrote 80 Pest unit tests across 6 test files covering metadata, fail/warn/pass paths, edge cases (empty strings, whitespace, duplicates, future dates, invalid formats, case sensitivity, boundary lengths). All 235 tests pass, Pint clean.
- **TASK 8**: Created the validation engine foundation: `CheckStatus` enum (pass/warn/fail), `CheckResult` value object with static factory methods (`pass()`, `warn()`, `fail()`), status helpers (`isPassing()`, `isWarning()`, `isFailing()`), and `toArray()` for JSON serialization. `CheckInterface` defines the contract: `name()`, `run(SimpleXMLElement)`, `severity()`. `FeedValidator` orchestrator accepts separate `$channelChecks` and `$episodeChecks` arrays, runs channel checks against the full feed and episode checks against individual `<item>` elements (capped at 10 episodes), formats results with check metadata for JSON storage. Supports both RSS 2.0 and Atom feeds with proper namespace handling. Includes `summarize()` static method for counting pass/warn/fail totals. Moved shared test helpers (`fixture()`, `loadFeedFixture()`) to `tests/Pest.php`. Wrote 27 tests: 12 for CheckResult (factory methods, constructors, status helpers, serialization, immutability) and 15 for FeedValidator (empty checks, single/multiple channel checks, episode iteration with title/guid extraction, 10-episode limit, missing title/guid fallbacks, combined channel+episode, summarize, Atom feed support).
- **TASK 14**: Created the health scoring engine in `app/Services/Scoring/`. **HealthScore** value object holds overall score (0-100) and per-category breakdowns with `toArray()` for JSON serialization. **HealthScorer** service takes FeedValidator output, flattens all check results (channel + episode), and calculates scores using weighted deductions: -10 per fail, -3 per warn, floored at 0. Maps all 14 checks to three categories via const lookup: **Compliance** (Artwork, Category, Explicit Tag, Owner Email, Enclosure), **Technical** (Language, Website Link, GUID, PubDate, Duration), **Best Practices** (Author, Channel Description, Episode Title, Episode Description). Unknown checks default to Best Practices. Categories always appear in canonical order, even when empty. Wrote 19 Pest tests across 4 describe blocks covering: overall score calculation (pass/warn/fail deductions, floor at 0, episode inclusion, multi-episode accumulation), category mapping (compliance/technical/best_practices with counts and independent scores), value object (properties, serialization), and a realistic full-feed scenario. All 259 tests pass, Pint clean.
- **TASK 13**: Wired the full validation engine into the controller flow. Registered `FeedValidator` in `AppServiceProvider` with all 8 channel checks (ArtworkCheck, CategoryCheck, ExplicitTagCheck, AuthorCheck, OwnerEmailCheck, LanguageCheck, WebsiteLinkCheck, DescriptionCheck) and all 6 episode checks (EnclosureCheck, GuidCheck, PubDateCheck, DurationCheck, TitleCheck, DescriptionCheck). Uses `$app->make()` for dependency resolution so checks with `HttpFactory` injection (ArtworkCheck, EnclosureCheck) get their dependencies auto-resolved. Updated `FeedCheckController` to inject `FeedValidator` alongside `FeedFetcher`, run `validate()` after fetching, and store structured results (channel checks, episode checks, summary counts) in `results_json`. Added 6 new feature tests verifying: validation results stored in report, all channel checks registered, episode checks run per episode, check result structure (name/severity/status/message/suggestion), and summary count accuracy. All 240 tests pass, Pint clean.
- **TASK 15**: Created the SEO scoring engine in `app/Services/Scoring/`. **SeoScore** value object holds overall SEO score (0-100) and per-area detail breakdowns (show_title, show_description, episode_titles) with `toArray()` for JSON serialization. **SeoScorer** service analyzes the raw feed XML (not check results) for SEO quality. **Show title analysis**: scores title length on a 0-100 scale with sweet spot at 30-60 chars (100 points), penalties for too short (<20: 40pts), slightly short (20-29: 70pts), slightly long (61-70: 80pts), and too long (>70: 50pts); detects keyword stuffing via word frequency analysis (3+ repeated words triggers -20 penalty). **Show description analysis**: scores length with optimal range 250-600 chars (100pts), penalties for <100 (30pts), 100-249 (70pts), 601-4000 (90pts), >4000 (60pts); falls back to `<itunes:summary>` when `<description>` is missing. **Episode title analysis**: detects generic patterns matching "Episode N", "Ep. N", "Ep N", "#N" regex; scores proportionally to descriptive vs generic ratio; prefers `<itunes:title>` over `<title>`; caps at 10 episodes. Overall SEO score uses weighted average: title 30%, description 30%, episode titles 40%. Supports both RSS 2.0 and Atom feeds. Each detail includes score, status (pass/warn/fail), message, suggestion, and relevant metadata (length, generic_count, total_count). Wrote 37 Pest tests across 6 describe blocks covering: value object (properties, serialization), show title (missing, too short, optimal, slightly long, too long, keyword stuffing, boundary values), show description (missing, too short, moderate, optimal, long, excessive, iTunes fallback), episode titles (no episodes, all descriptive, all generic, mixed, pattern detection, itunes:title preference, 10-episode cap), overall score (weighted calculation, empty feed, realistic scenario), and Atom feed support. All 302 tests pass, Pint clean.
- **TASK 16**: Integrated both scoring engines into the controller pipeline. Updated `FeedCheckController` to inject `HealthScorer` and `SeoScorer` alongside existing services. After fetching and validating the feed, the controller now runs `HealthScorer::score()` on validation results and `SeoScorer::score()` on the raw feed XML. Stores `overall_score` from HealthScorer in the FeedReport model (no longer hardcoded to 0). Stores both `health_score` (overall + category breakdowns) and `seo_score` (overall + detail breakdowns) in `results_json` alongside existing validation data. Added 6 new feature tests: health score stored in report (0-100 range), health score structure with category breakdowns and consistent counts, SEO score stored with correct structure, SEO score details with required fields per area, full pipeline consistency test (verifying all sections present, health score matches overall_score, category totals match summary, episode count matches fixture), and non-zero score for well-formed feeds. All 302 tests pass, Pint clean.
